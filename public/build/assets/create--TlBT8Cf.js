import{r as p,m as Q,j as e,L as U}from"./app-MJnXPJTR.js";import{I as _}from"./input-error-BXBBEtym.js";import{B as m}from"./button-D8ZOub8V.js";import{C as K,a as V,b as H,d as J,c as X}from"./card-B3ZV-1Z-.js";import{I}from"./input-C60pUzQS.js";import{L as o}from"./label-BQGDO_2u.js";import{R as O,a as v}from"./radio-group-BUExo__s.js";import{S as Z,a as W,b as Y,c as ee,d as z}from"./select-DxOhnnfs.js";import{A as te}from"./admin-layout-DwY-7nB3.js";import{E as y}from"./Editor-dfMU3jH6.js";import{t as w}from"./index-CFMrrp9j.js";import{I as B}from"./image-plus-BnJNJdJX.js";import{T as ie}from"./trash-qnDvar_J.js";import"./utils-CUqJu1qg.js";import"./index-Btu9k_tb.js";import"./index-BMcBjRZu.js";import"./index-Cwht8YfP.js";import"./dropdown-menu-ge6HGJYW.js";import"./index-K4iIgLTv.js";import"./index-DllIsYiB.js";import"./index-eEmAuPkl.js";import"./index-DdozAOjD.js";import"./index-qRa69IvQ.js";import"./index-B5NE_PHB.js";import"./floating-ui.react-dom-B5TUsM0C.js";import"./index-BsoCTf3M.js";import"./index-Y4qKod9a.js";import"./Combination-DFY99MmO.js";import"./createLucideIcon-B3sKuZQv.js";import"./check-CdgVof5_.js";import"./index-B4LS8pbn.js";import"./index-YMiNU3ds.js";import"./chevron-down-BECR2wGv.js";import"./chevron-up-DS_NSP-_.js";import"./sonner-DjS78TOu.js";import"./breadcrumbs-Dqhki5MS.js";import"./index-f_PI-uk2.js";import"./x-BpNdBcWT.js";import"./tooltip-CUZk6Xp5.js";import"./avatar-D74Liwd2.js";import"./use-initials-BRYLK5PJ.js";import"./user-BZbZYRir.js";import"./breadcrumb-DN0zU_-Q.js";import"./chevron-right-CH4dlfgG.js";import"./app-sidebar-header-hSq3_cVh.js";import"./chevrons-up-down-iZBpua3F.js";import"./user-check-Dsa_dTX0.js";import"./users-cI2ahPXJ.js";import"./monitor-play-CsS2dodc.js";import"./presentation-DWbPL-g6.js";import"./gift-BIIEAq3E.js";import"./banknote-CpQwfz06.js";import"./dollar-sign--E6MQP-r.js";import"./file-text-CEfoG5s3.js";import"./index-l7HDq_Il.js";function st({course:h,quiz:u}){const P=p.useRef(null),g=p.useRef(null),x=p.useRef({}),[s,F]=p.useState([{option_text:"",option_image:null,option_image_preview:null,is_correct:!1},{option_text:"",option_image:null,option_image_preview:null,is_correct:!1}]),[N,M]=p.useState("multiple_choice"),[k,C]=p.useState(null),{data:f,setData:c,post:R,processing:q,errors:b}=Q({question_text:"",question_image:null,type:"multiple_choice",explanation:"",quiz_id:u.id,options:s}),E=[{title:"Kelas Online",href:route("courses.index")},{title:h.title,href:route("courses.show",{course:h.id})},{title:u.title,href:route("quizzes.show",{course:h.id,quiz:u.id})},{title:"Tambah Pertanyaan",href:route("questions.create",{course:h.id,quiz:u.id})}],j=2*1024*1024,S=i=>i.size>j?(w.error("Ukuran file tidak boleh melebihi 2MB!"),!1):!0,n=i=>{F(i),c("options",i)},G=i=>{var a;const t=(a=i.target.files)==null?void 0:a[0];if(t){if(!S(t)){i.target.value="";return}c("question_image",t);const r=new FileReader;r.onloadend=()=>{C(r.result)},r.readAsDataURL(t)}},T=()=>{c("question_image",null),C(null),g.current&&(g.current.value="")},L=(i,t)=>{var r;const a=(r=t.target.files)==null?void 0:r[0];if(a){if(!S(a)){t.target.value="";return}const l=new FileReader;l.onloadend=()=>{const d=[...s];d[i].option_image=a,d[i].option_image_preview=l.result,n(d)},l.readAsDataURL(a)}},$=i=>{const t=[...s];t[i].option_image=null,t[i].option_image_preview=null,n(t),x.current[i]&&(x.current[i].value="")},A=i=>{if(i.preventDefault(),f.question_image&&f.question_image.size>j){w.error("Gambar pertanyaan melebihi ukuran maksimal 2MB!");return}for(let t=0;t<s.length;t++)if(s[t].option_image&&s[t].option_image.size>j){w.error(`Gambar opsi ${String.fromCharCode(65+t)} melebihi ukuran maksimal 2MB!`);return}R(route("questions.store"),{preserveScroll:!0,onError:()=>{var t;return(t=P.current)==null?void 0:t.focus()}})};return e.jsxs(te,{breadcrumbs:E,children:[e.jsx(U,{title:"Tambah Pertanyaan"}),e.jsx("div",{className:"px-4 py-4 md:px-6",children:e.jsxs(K,{children:[e.jsxs(V,{children:[e.jsx(H,{children:"Tambah Pertanyaan"}),e.jsxs(J,{children:['Buat pertanyaan baru untuk quiz "',u.title,'"']})]}),e.jsx(X,{children:e.jsxs("form",{className:"space-y-4",onSubmit:A,children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(o,{htmlFor:"question_text",children:"Pertanyaan"}),e.jsx(y,{apiKey:"f3upn9g1gl6r4m6ybrpbtceg23fxg21slzsgyhg0bui1qq4m",value:f.question_text,onEditorChange:i=>c("question_text",i),init:{plugins:["anchor","autolink","charmap","codesample","emoticons","image","link","lists","media","searchreplace","table","visualblocks","wordcount"],toolbar:"undo redo | blocks fontfamily fontsize | bold italic underline strikethrough | link image media table | align lineheight | checklist numlist bullist indent outdent | emoticons charmap | removeformat",height:300}}),e.jsx(_,{message:b.question_text}),e.jsx(o,{htmlFor:"question_image",className:"mt-2",children:"Gambar Pertanyaan (Opsional, Max 2MB)"}),k?e.jsxs("div",{className:"",children:[e.jsx("img",{src:k,alt:"Preview",className:"h-48 rounded-lg border object-cover"}),e.jsx(m,{type:"button",variant:"destructive",size:"sm",className:"mt-2 w-full md:w-fit",onClick:T,children:"Hapus Gambar"})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{ref:g,type:"file",accept:"image/*",onChange:G,className:"hidden",id:"question_image"}),e.jsxs(m,{type:"button",variant:"outline",onClick:()=>{var i;return(i=g.current)==null?void 0:i.click()},className:"w-full",children:[e.jsx(B,{className:"mr-2 h-4 w-4"}),"Upload Gambar (Max 2MB)"]})]}),e.jsx(_,{message:b.question_image}),e.jsx(o,{htmlFor:"explanation",className:"mt-2",children:"Pembahasan (Opsional)"}),e.jsx(y,{apiKey:"f3upn9g1gl6r4m6ybrpbtceg23fxg21slzsgyhg0bui1qq4m",value:f.explanation,onEditorChange:i=>c("explanation",i),init:{plugins:["anchor","autolink","charmap","codesample","emoticons","image","link","lists","media","searchreplace","table","visualblocks","wordcount"],toolbar:"undo redo | blocks fontfamily fontsize | bold italic underline strikethrough | link image media table | align lineheight | checklist numlist bullist indent outdent | emoticons charmap | removeformat",height:200}}),e.jsx(_,{message:b.explanation}),e.jsx(o,{htmlFor:"type",className:"mt-2",children:"Tipe Pertanyaan"}),e.jsxs(Z,{value:N,onValueChange:i=>{const t=i;M(t),c("type",t),n(t==="true_false"?[{option_text:"Benar",option_image:null,option_image_preview:null,is_correct:!1},{option_text:"Salah",option_image:null,option_image_preview:null,is_correct:!1}]:[{option_text:"",option_image:null,option_image_preview:null,is_correct:!1},{option_text:"",option_image:null,option_image_preview:null,is_correct:!1}])},children:[e.jsx(W,{className:"w-full",children:e.jsx(Y,{placeholder:"Pilih tipe pertanyaan"})}),e.jsxs(ee,{children:[e.jsx(z,{value:"multiple_choice",children:"Pilihan Ganda"}),e.jsx(z,{value:"true_false",children:"Benar/Salah"})]})]})]}),e.jsxs("div",{children:[e.jsx(o,{children:"Opsi Jawaban"}),e.jsx("p",{className:"mb-2 text-sm text-gray-500",children:"Setiap opsi harus memiliki teks atau gambar (atau keduanya)"}),e.jsx("div",{className:"mt-2 space-y-4",children:N==="true_false"?e.jsxs(O,{value:s.findIndex(i=>i.is_correct).toString(),onValueChange:i=>{const t=Number(i),a=s.map((r,l)=>({...r,is_correct:l===t}));n(a)},children:[e.jsxs("div",{className:"mb-1 flex items-center space-x-2",children:[e.jsx(v,{value:"0",id:"option-0"}),e.jsx(o,{htmlFor:"option-0",children:"Benar"})]}),e.jsxs("div",{className:"mb-1 flex items-center space-x-2",children:[e.jsx(v,{value:"1",id:"option-1"}),e.jsx(o,{htmlFor:"option-1",children:"Salah"})]})]}):e.jsxs(e.Fragment,{children:[s.map((i,t)=>e.jsxs("div",{className:`rounded-lg border-2 p-4 transition-colors ${i.is_correct?"border-green-500 bg-green-50":"border-gray-200 bg-white"}`,children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsxs(o,{className:`text-base font-semibold ${i.is_correct?"text-green-700":""}`,children:["Opsi ",String.fromCharCode(65+t),i.is_correct&&e.jsx("span",{className:"ml-2 text-xs font-normal text-green-600",children:"(Jawaban Benar)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{value:s.findIndex(a=>a.is_correct).toString(),onValueChange:a=>{const r=Number(a),l=s.map((d,D)=>({...d,is_correct:D===r}));n(l)},children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(v,{value:t.toString(),id:`correct-${t}`}),e.jsx(o,{htmlFor:`correct-${t}`,className:"text-sm font-normal",children:"Jawaban Benar"})]})}),s.length>2&&e.jsx(m,{type:"button",variant:"destructive",size:"sm",onClick:()=>{const a=s.filter((r,l)=>l!==t);n(a)},children:e.jsx(ie,{className:"h-4 w-4"})})]})]}),e.jsx(y,{apiKey:"f3upn9g1gl6r4m6ybrpbtceg23fxg21slzsgyhg0bui1qq4m",value:i.option_text,onEditorChange:a=>{const r=[...s];r[t].option_text=a,n(r)},init:{plugins:["anchor","autolink","charmap","codesample","emoticons","image","link","lists","media","searchreplace","table","visualblocks","wordcount"],toolbar:"undo redo | blocks fontsize | bold italic underline | link image table | align | numlist bullist | emoticons charmap | removeformat",height:150,menubar:!1,statusbar:!1}}),e.jsxs("div",{className:"mt-3",children:[e.jsxs(o,{className:"text-sm",children:["Gambar Opsi ",String.fromCharCode(65+t)," (Opsional, Max 2MB)"]}),i.option_image_preview?e.jsxs("div",{className:"",children:[e.jsx("img",{src:i.option_image_preview,alt:"Preview",className:"h-32 rounded border object-cover"}),e.jsx(m,{type:"button",variant:"destructive",size:"sm",className:"mt-2 w-full text-xs md:w-fit",onClick:()=>$(t),children:"Hapus Gambar"})]}):e.jsxs(e.Fragment,{children:[e.jsx(I,{ref:a=>{x.current[t]=a},type:"file",accept:"image/*",onChange:a=>L(t,a),className:"hidden",id:`option_image_${t}`}),e.jsxs(m,{type:"button",variant:"outline",size:"sm",onClick:()=>{var a;return(a=x.current[t])==null?void 0:a.click()},className:"mt-2 w-full",children:[e.jsx(B,{className:"mr-2 h-4 w-4"}),"Upload Gambar (Max 2MB)"]})]})]})]},t)),e.jsx(m,{type:"button",variant:"secondary",size:"sm",className:"w-full",onClick:()=>n([...s,{option_text:"",option_image:null,option_image_preview:null,is_correct:!1}]),children:"+ Tambah Opsi"})]})}),e.jsx(_,{message:b.options})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(m,{type:"button",variant:"outline",onClick:()=>window.history.back(),className:"hover:cursor-pointer",children:"Batal"}),e.jsx(m,{disabled:q,type:"submit",className:"hover:cursor-pointer",children:q?"Menyimpan...":"Simpan Pertanyaan"})]})]})})]})})]})}export{st as default};
