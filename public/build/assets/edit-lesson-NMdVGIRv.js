import{r as a,j as e}from"./app-B3wVvp7Q.js";import{I as G}from"./input-error-CKXmG0-f.js";import{B as J}from"./button-CHpVQBzx.js";import{b as O,c as X,d as Z,e as H,f as ee}from"./dialog-CumpFd8U.js";import{I as d}from"./input-DEd_IB7X.js";import{L as o}from"./label-DzhhEM84.js";import{S as te,a as ie,b as re,c as ae,e as se,d as u}from"./select-CzdPnKH7.js";import{S as K}from"./switch-CWGOXWcu.js";import{T as W}from"./textarea-D11aPByZ.js";import{E as le}from"./Editor-CoD25Aib.js";/* empty css            */import"./utils-Cx_xNk1e.js";import"./index-Qd2omNFz.js";import"./index-CCW6VlQC.js";import"./index-BOdlRzdx.js";import"./index-CLNjrBH_.js";import"./Combination-WS-7e2Km.js";import"./x-oH7p7yGO.js";import"./createLucideIcon-DkMZzWTD.js";import"./index-CIzLg9zF.js";import"./index-DIDjvU1J.js";import"./index-COYA6pXk.js";import"./index-Btv03HWO.js";import"./index-HGTiXcud.js";import"./index-BmNTl2TC.js";import"./floating-ui.react-dom-BDHe46Rp.js";import"./index-BcQ5iyVG.js";import"./index-DDZPV-2E.js";import"./index-BKtlHtYI.js";import"./chevron-down-Bu3RDr5p.js";import"./check-BNsWd7VD.js";import"./chevron-up-CNc-NsP_.js";import"./index-CAkQeBwg.js";function oe(p){const h=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/,t=p.match(h);return t&&t[2].length===11?t[2]:""}const ne=50*1024*1024;function Re({setOpen:p,onEdit:h,lesson:t}){var L,M,B,Q,U,V;const[x,y]=a.useState(t.title),[s,w]=a.useState(t.type),[k,z]=a.useState(t.description??""),[f,F]=a.useState(t.is_free??!1),[N,S]=a.useState(t.content??""),[c,_]=a.useState(t.video_url??""),[r,g]=a.useState(t.attachment??null),[Y,v]=a.useState(""),[q,C]=a.useState(((M=(L=t.quizzes)==null?void 0:L[0])==null?void 0:M.instructions)||""),[D,P]=a.useState(((Q=(B=t.quizzes)==null?void 0:B[0])==null?void 0:Q.time_limit)||0),[E,I]=a.useState(((V=(U=t.quizzes)==null?void 0:U[0])==null?void 0:V.passing_score)||0),[b,j]=a.useState(t.is_preview!==void 0?t.is_preview:!0),T=a.useRef(null);a.useEffect(()=>{var i,l,n,m,R,A;y(t.title),w(t.type),z(t.description??""),F(t.is_free??!1),S(t.content??""),_(t.video_url??""),g(t.attachment??null),C(((l=(i=t.quizzes)==null?void 0:i[0])==null?void 0:l.instructions)||""),P(((m=(n=t.quizzes)==null?void 0:n[0])==null?void 0:m.time_limit)||0),I(((A=(R=t.quizzes)==null?void 0:R[0])==null?void 0:A.passing_score)||0),v(""),j(t.is_preview!==void 0?t.is_preview:!0)},[t]);const $=i=>{var l,n,m;if(i.preventDefault(),!x.trim()){v("Judul materi harus diisi"),(l=T.current)==null||l.focus();return}h({id:t.id,title:x,type:s,description:k,is_free:f,content:s==="text"?N:void 0,video_url:s==="video"?c:void 0,attachment:s==="file"?r??t.attachment:void 0,quizzes:s==="quiz"?[{id:(m=(n=t.quizzes)==null?void 0:n[0])==null?void 0:m.id,instructions:q,time_limit:D,passing_score:E}]:void 0,is_preview:s==="file"?b:t.is_preview})};return e.jsxs(O,{children:[e.jsx(X,{children:"Edit Materi"}),e.jsx(Z,{children:"Ubah judul, tipe, dan deskripsi materi."}),e.jsxs("form",{className:"space-y-6",onSubmit:$,children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(o,{htmlFor:"title",className:"sr-only",children:"Judul Materi"}),e.jsx(d,{id:"title",type:"text",name:"title",ref:T,value:x,onChange:i=>y(i.target.value),placeholder:"Judul Materi",autoComplete:"off"}),e.jsx(G,{message:Y}),e.jsx(o,{htmlFor:"description",className:"sr-only",children:"Deskripsi Materi"}),e.jsx(W,{id:"description",name:"description",value:k,onChange:i=>z(i.target.value),placeholder:"Deskripsi Materi (opsional)",className:"max-h-[300px] min-h-[80px] w-full resize-none break-words whitespace-pre-line",style:{overflowWrap:"break-word",wordBreak:"break-word"}}),e.jsx(o,{htmlFor:"type",className:"sr-only",children:"Tipe Materi"}),e.jsxs(te,{value:s,onValueChange:i=>w(i),children:[e.jsx(ie,{children:e.jsx(re,{placeholder:"Pilih tipe materi"})}),e.jsx(ae,{children:e.jsxs(se,{children:[e.jsx(u,{value:"text",children:"Text"}),e.jsx(u,{value:"video",children:"Video"}),e.jsx(u,{value:"file",children:"File"}),e.jsx(u,{value:"quiz",children:"Quiz"})]})})]}),s==="text"&&e.jsxs("div",{children:[e.jsx(o,{htmlFor:"content",className:"mb-1 block text-sm font-medium",children:"Konten Materi"}),e.jsx(le,{apiKey:"f3upn9g1gl6r4m6ybrpbtceg23fxg21slzsgyhg0bui1qq4m",value:N,onEditorChange:i=>S(i),init:{plugins:["anchor","autolink","charmap","codesample","emoticons","image","link","lists","media","searchreplace","table","visualblocks","wordcount"],onboarding:!1,toolbar:"undo redo | blocks fontfamily fontsize | bold italic underline strikethrough | link image media table mergetags | addcomment showcomments | spellcheckdialog a11ycheck typography | align lineheight | checklist numlist bullist indent outdent | emoticons charmap | removeformat",tinycomments_mode:"embedded",tinycomments_author:"Author name",mergetags_list:[{value:"First.Name",title:"First Name"},{value:"Email",title:"Email"}],height:300}})]}),s==="video"&&e.jsxs("div",{children:[e.jsx(o,{htmlFor:"video-link",className:"mb-1 block text-sm font-medium",children:"Link YouTube Video"}),e.jsx(d,{id:"video-link",type:"text",placeholder:"https://www.youtube.com/watch?v=xxxxxx",value:c,onChange:i=>_(i.target.value)}),c&&c.trim()!==""&&e.jsx("div",{className:"mt-2",children:e.jsx("iframe",{className:"rounded border",width:"100%",height:"250",src:c.includes("youtube.com")||c.includes("youtu.be")?`https://www.youtube.com/embed/${oe(c)}`:"",title:"YouTube Preview",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})})]}),s==="file"&&e.jsxs("div",{children:[e.jsx(o,{htmlFor:"attachment",className:"mb-1 block text-sm font-medium",children:"Upload File (Format PDF)"}),e.jsx(d,{id:"attachment",type:"file",onChange:i=>{var n;const l=((n=i.target.files)==null?void 0:n[0])??null;if(l&&l.size>ne){v("Ukuran file maksimal 50 MB"),g(null);return}g(l),l&&l.type!=="application/pdf"&&j(!1)}}),e.jsxs("div",{className:"mt-2 flex items-center space-x-2",children:[e.jsx(K,{id:"is-preview",checked:b,onCheckedChange:r&&r.type!=="application/pdf"?void 0:j,className:r&&r.type!=="application/pdf"?"opacity-50 cursor-not-allowed":""}),e.jsx(o,{htmlFor:"is-preview",className:r&&r.type!=="application/pdf"?"text-muted-foreground":"",children:b?"File hanya bisa dilihat (preview)":"File bisa di-download"})]}),r&&r.type!=="application/pdf"&&e.jsx("div",{className:"mt-1 text-xs text-muted-foreground",children:"Preview hanya tersedia untuk file PDF. File non-PDF otomatis bisa di-download."}),(()=>{let i=null;return r instanceof File?i={type:"file",url:URL.createObjectURL(r)}:typeof r=="string"&&r&&(i={type:"file",url:r.startsWith("http")?r:`/storage/${r}`}),(i==null?void 0:i.type)==="file"&&i.url&&e.jsxs("div",{className:"mt-2 w-full rounded border p-2",children:[e.jsxs("div",{className:"mt-2 flex items-center gap-2 text-xs",children:[r instanceof File&&r.type==="application/pdf"||typeof r=="string"&&r?e.jsx("a",{href:i.url,target:"_blank",rel:"noopener noreferrer",className:"mb-2 rounded bg-black/60 px-2 py-1 text-xs text-white hover:bg-black/80",title:"Tampilkan Fullscreen",children:r instanceof File?"Fullscreen":"Lihat File Lama"}):null,r instanceof File&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"font-medium",children:"File:"}),e.jsx("span",{children:r.name}),e.jsxs("span",{children:["(",Math.round(r.size/1024)," KB)"]})]})]}),r instanceof File&&r.type==="application/pdf"||typeof r=="string"&&r?e.jsx("object",{data:i.url,type:"application/pdf",width:"100%",height:"200px",children:e.jsxs("p",{children:["Preview tidak tersedia."," ",e.jsx("a",{href:i.url,target:"_blank",rel:"noopener noreferrer",children:"Download PDF"})]})}):e.jsx("div",{className:"text-xs text-muted-foreground italic",children:"Preview hanya tersedia untuk file PDF."})]})})()]}),s==="quiz"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"quiz-instructions",className:"sr-only",children:"Instruksi Quiz"}),e.jsx(W,{id:"quiz-instructions",name:"quiz-instructions",value:q,onChange:i=>C(i.target.value),placeholder:"Instruksi untuk quiz (opsional)",className:"max-h-[300px] min-h-[80px] w-full resize-none break-words whitespace-pre-line",style:{overflowWrap:"break-word",wordBreak:"break-word"}}),e.jsx(o,{htmlFor:"quiz-time-limit",className:"mb-1 block text-sm font-medium",children:"Time Limit (menit)"}),e.jsx(d,{id:"quiz-time-limit",type:"number",min:0,placeholder:"0 (tanpa batas waktu)",value:D,onChange:i=>P(Number(i.target.value))}),e.jsx(o,{htmlFor:"quiz-passing-score",className:"mb-1 block text-sm font-medium",children:"Passing Score"}),e.jsx(d,{id:"quiz-passing-score",type:"number",min:0,max:100,placeholder:"Nilai minimal lulus (0-100)",value:E,onChange:i=>I(Number(i.target.value))})]}),e.jsxs("div",{className:"mt-2 flex items-center space-x-2",children:[e.jsx(K,{id:"is-free",checked:f,onCheckedChange:F}),e.jsx(o,{htmlFor:"is-free",children:f?"Materi ini gratis":"Materi ini berbayar"})]})]}),e.jsxs(H,{className:"gap-2",children:[e.jsx(ee,{asChild:!0,children:e.jsx(J,{variant:"secondary",onClick:()=>p(!1),className:"hover:cursor-pointer",children:"Batal"})}),e.jsx(J,{type:"submit",className:"hover:cursor-pointer",children:"Simpan Perubahan"})]})]})]})}export{Re as default};
